<!DOCTYPE html>
<html>
<head>
<title>Magic Heal – Multipurpose Herbal Powder</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<style>
body{margin:0;font-family:Arial;background:#eef7f1}
header{background:linear-gradient(135deg,#1f7a54,#2ecc71);color:white;padding:30px;text-align:center}
section{padding:30px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px}
.box{background:white;padding:20px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,.15);transition:.3s}
.box:hover{transform:scale(1.03)}
button{background:#1f7a54;color:white;border:none;padding:10px 20px;border-radius:5px;font-weight:bold;cursor:pointer}
input,textarea{width:100%;padding:8px;margin:8px 0}
h2{text-align:center}
</style>
</head>

<body>

<header>
<h1>MAGIC HEAL</h1>
<p>Multipurpose Herbal Powder</p>
</header>

<section>
<h2>Products</h2>
<div id="productList" class="grid"></div>
</section>

<section>
<h2>Customer Details</h2>
<div class="box">
<input id="custName" placeholder="Your Name">
<input id="custPhone" placeholder="Mobile Number">
<textarea id="custAddress" placeholder="Delivery Address"></textarea>
<button onclick="payNow()">Pay & Place Order</button>
</div>
</section>

<section>
<h2>Track Your Orders</h2>
<div class="box" id="trackBox"></div>
</section>

<section>
<h2>Admin Panel</h2>
<div class="box">
<table width="100%" border="1" cellpadding="6" id="adminTable"></table>
</div>
</section>

<script>
let inventory = JSON.parse(localStorage.getItem("inventory")) || {
 "Magic Heal 100g":{price:299,stock:20},
 "Magic Heal 200g":{price:550,stock:15},
 "Family Pack":{price:1150,stock:10}
};
let orders = JSON.parse(localStorage.getItem("orders")) || [];

function saveAll(){
 localStorage.setItem("inventory",JSON.stringify(inventory));
 localStorage.setItem("orders",JSON.stringify(orders));
}

function loadProducts(){
 let html="";
 for(let p in inventory){
  let i=inventory[p];
  html+=`<div class='box'>
    <h3>${p}</h3>
    <p>Price: ₹${i.price}</p>
    <p>Stock: ${i.stock}</p>
    <button ${i.stock==0?"disabled":""} onclick="selectProduct('${p}')">Buy Now</button>
  </div>`;
 }
 document.getElementById("productList").innerHTML=html;
}

let selectedProduct="";
function selectProduct(p){ selectedProduct=p; alert(p+" selected"); }

function payNow(){
 if(!selectedProduct) return alert("Please select a product");
 let amount = inventory[selectedProduct].price * 100;

 var options = {
  "key": "YOUR_RAZORPAY_KEY_HERE",
  "amount": amount,
  "currency": "INR",
  "name": "Magic Heal",
  "description": selectedProduct,
  "handler": function (response){
     placeOrder(response.razorpay_payment_id);
  }
 };
 new Razorpay(options).open();
}

function placeOrder(paymentId){
 let order={
  name:custName.value,
  phone:custPhone.value,
  address:custAddress.value,
  product:selectedProduct,
  payment:paymentId,
  status:"Order Received",
  date:new Date().toLocaleString()
 };

 orders.push(order);
 inventory[selectedProduct].stock--;
 saveAll();
 updateAdmin();
 updateTracking();
 loadProducts();

 let msg = `NEW MAGIC HEAL ORDER%0AName:${order.name}%0APhone:${order.phone}%0AProduct:${order.product}%0APayment:${paymentId}`;
 window.open("https://wa.me/917678455380?text="+msg);
}

function updateAdmin(){
 let html="<tr><th>Name</th><th>Phone</th><th>Product</th><th>Status</th></tr>";
 orders.forEach((o,i)=>{
  html+=`<tr>
   <td>${o.name}</td>
   <td>${o.phone}</td>
   <td>${o.product}</td>
   <td>
    <select onchange="changeStatus(${i},this.value)">
     <option ${o.status=="Order Received"?"selected":""}>Order Received</option>
     <option ${o.status=="Packed"?"selected":""}>Packed</option>
     <option ${o.status=="Shipped"?"selected":""}>Shipped</option>
     <option ${o.status=="Out for Delivery"?"selected":""}>Out for Delivery</option>
     <option ${o.status=="Delivered"?"selected":""}>Delivered</option>
    </select>
   </td>
  </tr>`;
 });
 document.getElementById("adminTable").innerHTML=html;
}

function changeStatus(i,val){
 orders[i].status=val;
 saveAll();
 updateTracking();
}

function updateTracking(){
 let html="";
 orders.forEach(o=>{
  html+=`<p><b>${o.product}</b> – ${o.status}<br><small>${o.date}</small></p><hr>`;
 });
 document.getElementById("trackBox").innerHTML=html;
}

loadProducts();
updateAdmin();
updateTracking();
</script>

</body>
</html>
